# mireaPandoc
Фильтр pandoc для создания отчётов МИРЭА в формате .docx

## Что это такое и зачем нужно

pandoc - инструмент для преобразования документов в различных форматах

Его можно использовать для создания документов, в том числе должным образом оформленных.

Фильтр pandoc - это программа, принимающая на вход синтаксическое дерево документа (в формате JSON) и выдающая на вход новое, модифицированное дерево, которое можно наконец привести к требуемому выходному формату. 

Таким образом, в этом репозитории находится вспомогательный скрипт и несколько (на данный момент несколько) документов для "шаблона" форматирования.

## Требования

Чтобы воспользоваться скриптом, требуется:

1. Установить pandoc и python3 (от версии 3.7 включительно)

2. Офисный пакет технически НЕ требуется, но без него вам будет крайне сложно скорректировать результат

3. Использовать текстовый редактор с кодировкой UTF-8 (так что даже Блокнот подойдёт, главное не забыть поменять кодировку)

pandoc является кроссплатформенной утилитой, доступной на большинстве популярных и не очень декстопных платформ: Windows, Linux, macOS, FreeBSD, ... ; то же верно и для Python (с некоторыми оговорками касаемо подозрительно краткого срока официальной поддержки устаревших версий ОС Windows).
Таким образом, предлагаемое решение абсолютно кроссплатформенно и доступно _всем_.

## Использование

1. Создайте текстовый файл. Целевой входной формат (__из__ которого прежде всего ожидается конвертация) --- это Pandoc Markdown в кодировке UTF-8; версия разметки Markdown с некоторыми расширениями.

2. Пример содержания файла приводится в файле sample.md в данном репозитории. Чтобы скачать репозиторий, нажмите Code >> Download ZIP и распакуйте ZIP.

3. Уже установив python и pandoc, 
    1) запустите в командной строке вашей операционной системы (терминал Linux или macOS, cmd.exe либо powershell Windows ... ),
    2) перейдите в папку репозитория командой cd (либо в след.пункте указывайте полные пути до всех файлов!)
    3) выполните следующую команду:
~~~~
pandoc --filter filter.py --reference-doc custom-reference3.docx -o sample.docx --no-highlight sample.md
~~~~
4) __Возможно__, программа выведет ошибку или предупреждение. Любые предупреждения или ошибки следует учитывать и исправлять, так как
    * наличие ошибок говорит о безусловно имеющихся в исходном документе нарушениях нормоконтроля,
    * наличие предупреждений о вероятных нарушениях, которые невозможно автоматически исправить.

## Недостатки и планы на будущее

- [ ] программа не создаёт отчёт полностью: *не* создаются титульный лист и содержание.
- [ ] всё ещё возможны ошибки форматирования
- [ ] плохо поддерживается форматирование таблиц
- [ ] отсутствует эвристика для нахождения неверных употреблений тире и дефисов (тире в Markdown ставится как ``` --- ```, отделенное пробелами от слов, а дефис как ```-``` без отделения пробелами от слов
- [ ] отсутствуют эвристики, связанные с нахождением опечаток, орфографических и грамматических ошибок в тексте
- [ ] могут не работать некоторые продвинутые возможности Pandoc Markdown (такие как ссылки на разделы)
- [ ] не поддерживается полноценное форматирование выносных уравнений (формулы в центре листа)
- [ ] отсутствует поддержка автоматизированного создания списка литературы по ссылкам на источники в формате ГОСТ из других форматов (таких как Biblatex). Насколько мне известно, данная задача не была решена в полном объёме.
